var CollisionManager=function(a){this.game=a;this.spacecraft=a.spacecraft;this.meteors=a.meteors;this.enemies=a.enemies;this.collisionDelayTimer=0};CollisionManager.prototype.checkAndResolve=function(a){this.collisionDelayTimer+=a;if(this.collisionDelayTimer>10){this.checkMeteorsWithMeteors();this.checkSpacecraftWithMeteors();this.checkSpacecraftWithEnemies();this.checkSpacecraftBulletsWithMeteorsEnemies();this.checkEnemyBulletsWithSpacecraft();this.collisionDelayTimer=0}this.checkSpacecraftWithWalls()};CollisionManager.prototype.checkMeteorsWithMeteors=function(){if(this.meteors.length<2){return}for(var b=0;b<this.meteors.length-1;b++){for(var a=b+1;a<this.meteors.length;a++){if(!this.meteors[b].isOnFire()&&!this.meteors[a].isOnFire()){if(this.circleCircleCollision(this.meteors[b],this.meteors[a])){this.resolveElasticCollision(this.meteors[b],this.meteors[a]);this.meteors[b].updateRotation(this.meteors[a].xCentre);this.meteors[a].updateRotation(this.meteors[b].xCentre)}}}}};CollisionManager.prototype.checkSpacecraftWithWalls=function(){if(this.spacecraft.xPosition<5){this.spacecraft.xVelocity=0;this.spacecraft.isLeftWall=true;this.spacecraft.xPosition=5}if(this.spacecraft.xPosition+this.spacecraft.width+5>this.game.canvas.width){this.spacecraft.xVelocity=0;this.spacecraft.isRightWall=true;this.spacecraft.xPosition=this.game.canvas.width-this.spacecraft.width-5}if(this.spacecraft.yPosition<5){this.spacecraft.yVelocity=0;this.spacecraft.isUpWall=true;this.spacecraft.yPosition=5}if(this.spacecraft.yPosition+this.spacecraft.height+5>this.game.canvas.height){this.spacecraft.yVelocity=0;this.spacecraft.isDownWall=true;this.spacecraft.yPosition=this.game.canvas.height-this.spacecraft.height-5}};CollisionManager.prototype.checkSpacecraftWithEnemies=function(){for(var a=0;a<this.enemies.length;a++){if(!this.enemies[a].isOnFire()&&this.rectRectCollision(this.spacecraft,this.enemies[a])){if(this.circleRectCollision(this.spacecraft,this.enemies[a])){this.resolveElasticCollision(this.spacecraft,this.enemies[a]);this.enemies[a].explode();if(!this.spacecraft.isShieldUp){this.spacecraft.livesRemaining--}else{this.spacecraft.score+=10}}}}};CollisionManager.prototype.rectRectCollision=function(b,a){return b.xPosition<a.xPosition+a.width&&b.xPosition+b.width>a.xPosition&&b.yPosition<a.yPosition+a.height&&b.height+b.yPosition>a.yPosition};CollisionManager.prototype.circleCircleCollision=function(d,c){var b=d.xCentre-c.xCentre;var a=d.yCentre-c.yCentre;var e=Math.sqrt(b*b+a*a);return d.radius+c.radius>e};CollisionManager.prototype.circleRectCollision=function(f,d){var e=Math.abs(f.xCentre-d.xPosition-d.width/2);var c=Math.abs(f.yCentre-d.yPosition-d.height/2);if(e>(d.width/2+f.radius)){return false}if(c>(d.height/2+f.radius)){return false}if(e<=(d.width/2)){return true}if(c<=(d.height/2)){return true}var b=e-d.width/2;var a=c-d.height/2;return b*b+a*a<=(f.radius*f.radius)};CollisionManager.prototype.checkSpacecraftWithMeteors=function(){for(var a=0;a<this.meteors.length;a++){if(!this.meteors[a].isOnFire()&&this.circleCircleCollision(this.spacecraft,this.meteors[a])){if(this.circleRectCollision(this.meteors[a],this.spacecraft)){this.resolveElasticCollision(this.spacecraft,this.meteors[a]);this.meteors[a].explode();if(!this.spacecraft.isShieldUp){this.spacecraft.livesRemaining--}else{this.spacecraft.score+=5}}}}};CollisionManager.prototype.checkSpacecraftBulletsWithMeteorsEnemies=function(){for(var c=0;c<this.spacecraft.bullets.length;c++){if(this.spacecraft.bullets[c].isOnFire()){continue}for(var b=0;b<this.meteors.length;b++){if(this.meteors[b].isOnFire()){continue}if(this.circleRectCollision(this.meteors[b],this.spacecraft.bullets[c])){this.meteors[b].explode();this.spacecraft.bullets[c].explode();this.spacecraft.score+=5}}for(var a=0;a<this.enemies.length;a++){if(this.enemies[a].isOnFire()){continue}if(this.rectRectCollision(this.enemies[a],this.spacecraft.bullets[c])){this.enemies[a].explode();this.spacecraft.bullets[c].explode();this.spacecraft.score+=10}}}};CollisionManager.prototype.checkEnemyBulletsWithSpacecraft=function(){for(var b=0;b<this.enemies.length;b++){if(this.enemies[b].type==="enemyBlue"||this.enemies[b].type==="enemyRed"){continue}for(var a=0;a<this.enemies[b].bullets.length;a++){if(this.enemies[b].bullets[a].isOnFire()){continue}if(this.rectRectCollision(this.spacecraft,this.enemies[b].bullets[a])){if(this.circleRectCollision(this.spacecraft,this.enemies[b].bullets[a])){this.enemies[b].bullets[a].explode();if(!this.spacecraft.isShieldUp){this.spacecraft.livesRemaining--}}}}}};CollisionManager.prototype.resolveElasticCollision=function(b,a){};