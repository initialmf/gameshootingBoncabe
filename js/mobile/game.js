var Game=function(e,t){this.canvas=e,this.context=t,this.assetsManager=new AssetsManager,this.assetsManager.loadAll(),this.inputManager=new InputManager,this.fps=60,this.interval=1e3/this.fps,this.lastTime=(new Date).getTime(),this.currentTime=0,this.delta=0,this.frameId=0,this.isPaused=!1};Game.prototype.newGame=function(){this.background=new Background(this.canvas,this.assetsManager),this.spacecraft=new Spacecraft(this.canvas,this.inputManager,this.assetsManager),this.meteors=[],this.enemies=[],this.collisionManager=new CollisionManager(this),this.scorePanel=new ScorePanel(this),this.gameplayManager=new GameplayManager(this),this.inputManager.registerKeyListener(),this.inputManager.registerMouseListener(this)},Game.prototype.run=function(){this.frameId=window.requestAnimationFrame(this.run.bind(this)),this.currentTime=(new Date).getTime(),this.delta=this.currentTime-this.lastTime,this.delta>this.interval&&(this.isPaused||(this.update(this.delta),this.collisionManager.checkAndResolve(this.delta)),0==this.spacecraft.livesRemaining&&this.gameOver(),this.render(),this.lastTime=this.currentTime-this.delta%this.interval)},Game.prototype.update=function(e){if(this.background.update(),this.spacecraft.update(e),this.gameplayManager.update(e),1==window["var"])for(var t=0;t<this.meteors.length;t++)this.meteors[t].update(e);else if(2==window["var"])for(var t=0;t<this.enemies.length;t++)this.enemies[t].update(e);else if(3==window["var"]){for(var t=0;t<this.meteors.length;t++)this.meteors[t].update(e);for(var t=0;t<this.enemies.length;t++)this.enemies[t].update(e)}},Game.prototype.render=function(){if(this.background.draw(this.context),this.spacecraft.draw(this.context),1==window["var"])for(var e=0;e<this.meteors.length;e++)this.meteors[e].draw(this.context);else if(2==window["var"])for(var e=0;e<this.enemies.length;e++)this.enemies[e].draw(this.context);else if(3==window["var"]){for(var e=0;e<this.meteors.length;e++)this.meteors[e].draw(this.context);for(var e=0;e<this.enemies.length;e++)this.enemies[e].draw(this.context)}this.scorePanel.draw(this.context)},Game.prototype.gameOver=function(){window.location.href="../notify.php?score="+this.spacecraft.score,window.cancelAnimationFrame(this.frameId),this.assetsManager.audios.gameOver.play(),this.assetsManager.audios.gameOver.currentTime=0,jQuery("#score-field").html(this.spacecraft.score),jQuery("#game-over-box").show(),this.newGame()};