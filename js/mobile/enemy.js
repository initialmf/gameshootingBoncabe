var Enemy=function(t,i,e,s,h){this.xPosition=t,this.yPosition=i,this.type=e,this.assetsManager=s,this.spacecraft=h,this.width=65,this.height=66,this.xVelocity=0,this.yVelocity=0,this.mass=200,this.radius=this.width/2,this.xCentre=this.xPosition+this.radius,this.yCentre=this.yPosition+this.radius,"enemyBlue"===this.type||"enemyGreen"===this.type?(this.accelerateFactor=1,this.maxVelocity=7):(this.accelerateFactor=1,this.maxVelocity=20),this.behaviourStarted=!1,"enemyBlue"!==this.type&&"enemyRed"!==this.type&&"enemyBlack"!==this.type||(this.initialDescentDistance=Math.floor(501*Math.random())+100),"enemyGreen"!==this.type&&"enemyBlack"!==this.type||(this.bulletDelayTimer=0,this.bullets=[],this.startFire=!1,this.bulletCleanUpDelayTimer=0),this.flewToPlayer=!1,this.flewFromPlayer=!1,this.flyingToLeftWall=!1,this.flyingToRightWall=!1,this.goDown=!1,this.goUp=!1,this.goRight=!1,this.goLeft=!1,this.isExploding=!1,this.explosionTimer=0,this.isExploded=!1,this.explosionIndex=0};Enemy.prototype.update=function(t){if(!this.isExploded||"enemyBlue"!==this.type&&"enemyRed"!==this.type){if(this.isExploded&&0!==this.bullets.length){for(var i=0;i<this.bullets.length;i++)this.bullets[i].update(t);return void this.bulletsCleanUp(t)}if(!this.isExploded){if(this.doBehaviour(),this.slowDown(),this.updateDirection(),this.yPosition+=this.yVelocity/10,this.xPosition+=this.xVelocity/10,this.radius=this.width/2,this.xCentre=this.xPosition+this.radius,this.yCentre=this.yPosition+this.radius,("enemyGreen"===this.type||"enemyBlack"===this.type)&&this.startFire){this.bulletDelayTimer+=t,this.bulletDelayTimer>4e3&&(this.fire(),this.bulletDelayTimer=0);for(var i=0;i<this.bullets.length;i++)this.bullets[i].update(t);this.bulletsCleanUp(t)}this.isExploding&&(this.explosionTimer+=t,this.explosionTimer>50&&(this.explosionIndex++,this.explosionTimer=0),this.explosionIndex>20&&(this.isExploded=!0,this.isExploding=!1))}}},Enemy.prototype.draw=function(t){if(this.isExploded||this.isExploding?this.isExploding&&t.drawImage(this.assetsManager.images["explosion"+this.explosionIndex],this.xCentre-this.radius,this.yCentre-this.radius,2*this.radius,2*this.radius):t.drawImage(this.assetsManager.images[this.type],this.xPosition,this.yPosition,this.width,this.height),"enemyGreen"===this.type||"enemyBlack"===this.type)for(var i=0;i<this.bullets.length;i++)this.bullets[i].draw(t)},Enemy.prototype.updateDirection=function(){this.goUp&&0===this.yVelocity&&(this.yVelocity-=this.accelerateFactor),this.goUp&&Math.abs(this.yVelocity)<this.maxVelocity&&(this.yVelocity-=this.accelerateFactor),this.goDown&&0===this.yVelocity&&(this.yVelocity+=this.accelerateFactor),this.goDown&&Math.abs(this.yVelocity)<this.maxVelocity&&(this.yVelocity+=this.accelerateFactor),this.goRight&&0===this.xVelocity&&(this.xVelocity+=this.accelerateFactor),this.goRight&&Math.abs(this.xVelocity)<this.maxVelocity&&(this.xVelocity+=this.accelerateFactor),this.goLeft&&0===this.xVelocity&&(this.xVelocity-=this.accelerateFactor),this.goLeft&&Math.abs(this.xVelocity)<this.maxVelocity&&(this.xVelocity-=this.accelerateFactor)},Enemy.prototype.slowDown=function(){this.yVelocity<0&&this.goDown&&(this.yVelocity+=this.accelerateFactor),this.yVelocity>0&&this.goUp&&(this.yVelocity-=this.accelerateFactor),this.xVelocity>0&&this.goLeft&&(this.xVelocity-=this.accelerateFactor),this.xVelocity<0&&this.goRight&&(this.xVelocity+=this.accelerateFactor)},Enemy.prototype.doBehaviour=function(){"enemyBlue"===this.type?this.doBlueBehaviour():"enemyRed"===this.type?this.doRedBehaviour():"enemyGreen"===this.type?this.doGreenBehaviour():"enemyBlack"===this.type&&this.doBlackBehaviour()},Enemy.prototype.doBlueBehaviour=function(){if(this.behaviourStarted){if(this.yPosition<this.initialDescentDistance)return;this.xCentre<this.spacecraft.xCentre?(this.goLeft=!1,this.goRight=!0):this.xCentre>this.spacecraft.xCentre?(this.goLeft=!0,this.goRight=!1):(this.goLeft=!1,this.goRight=!1)}else this.goDown=!0,this.behaviourStarted=!0},Enemy.prototype.doRedBehaviour=function(){if(this.behaviourStarted){if(this.yPosition<this.initialDescentDistance)return;this.xCentre<this.spacecraft.xCentre?(this.goLeft=!1,this.goRight=!0):this.xCentre>this.spacecraft.xCentre?(this.goLeft=!0,this.goRight=!1):(this.goLeft=!1,this.goRight=!1)}else this.goDown=!0,this.behaviourStarted=!0},Enemy.prototype.doGreenBehaviour=function(){this.behaviourStarted?this.yPosition>0&&(this.yPosition>=700?this.startFire=!1:this.startFire=!0):(this.goDown=!0,this.behaviourStarted=!0)},Enemy.prototype.doBlackBehaviour=function(){if(this.behaviourStarted){if(this.yPosition>0&&(this.startFire=!0),this.yPosition>10&&!this.flewToPlayer&&!this.flewFromPlayer)this.goDown=!1,this.yVelocity=0,this.xCentre>this.spacecraft.xPosition&&this.xCentre<this.spacecraft.xPosition+this.spacecraft.width?this.flewToPlayer=!0:this.xCentre<this.spacecraft.xCentre?(this.goLeft=!1,this.goRight=!0):(this.goLeft=!0,this.goRight=!1);else if(this.flewToPlayer&&!this.flewFromPlayer)this.xCentre>300&&!this.flyingToRightWall?(this.goLeft=!0,this.goRight=!1,this.flyingToLeftWall=!0):this.flyingToLeftWall||(this.goLeft=!1,this.goRight=!0,this.flyingToRightWall=!0),(this.xPosition<50||this.xPosition>500)&&(this.goDown=!0,this.goLeft=!1,this.goRight=!1,this.xVelocity=0,this.flewFromPlayer=!0);else if(this.flewFromPlayer&&this.flewToPlayer){if(this.yPosition<this.initialDescentDistance)return;this.xCentre<this.spacecraft.xCentre?(this.goLeft=!1,this.goRight=!0):this.xCentre>this.spacecraft.xCentre?(this.goLeft=!0,this.goRight=!1):(this.goLeft=!1,this.goRight=!1),this.yPosition>=700&&(this.startFire=!1)}}else this.goDown=!0,this.behaviourStarted=!0},Enemy.prototype.bulletsCleanUp=function(t){if(this.bulletCleanUpDelayTimer+=t,this.bulletCleanUpDelayTimer>1e4){for(var i=0;i<this.bullets.length;i++)(this.bullets[i].yPosition>4e3||this.bullets[i].isExploded)&&(this.bullets.splice(i,1),i--);this.bulletCleanUpDelayTimer=0}},Enemy.prototype.fire=function(){this.bullets.push(new Bullet(this.xPosition+this.width/2-7,this.yPosition+this.height/2,"red",this.assetsManager)),this.assetsManager.audios.laserEnemy.play(),this.assetsManager.audios.laserEnemy.currentTime=0},Enemy.prototype.explode=function(){this.isExploding=!0,this.startFire=!1,this.assetsManager.audios.explosion.play(),this.assetsManager.audios.explosion.currentTime=0},Enemy.prototype.isOnFire=function(){return this.isExploded||this.isExploding};